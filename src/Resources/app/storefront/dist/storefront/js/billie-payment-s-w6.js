"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["billie-payment-s-w6"],{1226:(e,t,i)=>{var n,r,s,o=i(6285),a=i(8254);class l extends o.Z{init(){this._insertWidget(),this._registerEvents()}_registerEvents(){this.el.form.addEventListener("submit",this._submitForm.bind(this))}_submitForm(e){if(this._isAddressConfirmed())return!0;e.preventDefault(),BillieCheckoutWidget.mount({billie_config_data:{session_id:this.options.checkoutSessionId,merchant_name:this.options.merchantName},billie_order_data:this.options.checkoutData}).then((e=>{const t=new a.Z(window.accessKey,window.contextToken);let i="/billie-payment/update-addresses",n=window.location.href.match(/account\/order\/edit\/([A-Za-z0-9]+)/);n&&2===n.length&&(i+="/"+n[1]),"csrf"in window&&window.csrf.enabled&&"twig"===window.csrf.mode&&(e._csrf_token=this.options.csrfToken),t.post(i,JSON.stringify(e),(e=>{this._setAddressConfirmed(!0),this.el.value=this.options.checkoutSessionId,this.el.form.submit()}))})).catch((t=>{e.preventDefault(),console.error("Error occurred",t),window.location.reload()}))}_insertWidget(){var e,t,i,n,r,s,o;window.billiePaymentData=this.options.checkoutData,e=window,t=document,i="script",n="bcw",r=this.options.src,e.BillieCheckoutWidget=n,e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},e.billieSrc=r,s=t.createElement(i),o=t.getElementsByTagName(i)[0],s.id=n,s.src=r,s.charset="utf-8",s.async=1,o.parentNode.insertBefore(s,o),bcw("init")}_setAddressConfirmed(e){this.el.form.dataset.billieConfirmed=parseInt(e)}_isAddressConfirmed(){return 1===parseInt(this.el.form.dataset.billieConfirmed)}}n=l,s={src:null,checkoutSessionId:null,merchantName:null,checkoutData:null,csrfToken:""},(r=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(r="options"))in n?Object.defineProperty(n,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[r]=s;const c=window.PluginManager;"BillieCheckout"in c.getPluginList()||c.register("BillieCheckout",l,'[data-billie-checkout="true"]')}},e=>{e.O(0,["vendor-node","vendor-shared"],(()=>{return t=1226,e(e.s=t);var t}));e.O()}]);